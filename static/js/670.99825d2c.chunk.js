"use strict";(self.webpackChunkinstragram=self.webpackChunkinstragram||[]).push([[670],{3631:function(e,t,r){r.r(t),r.d(t,{default:function(){return C}});var n=r(4165),s=r(3433),a=r(5861),i=r(9439),u=r(2791),o=r(9460),c=r(2423),l=r(2222),d=r(7689),f=r(4892),p=r(7799),m=r(9222),x=r(1087),h=r(8094),v=r(4850),g=r(1248),Z=r(6112),I=r(6881),b=r(6130),N=r(184),j=function(e){var t,r,s,o=e.postImage,c=e.user,l=e.postId,d=(0,u.useState)(),j=(0,i.Z)(d,2),k=j[0],w=j[1],y=(0,f.C)((function(e){return e.user.user})),C=(0,f.C)((function(e){return e.anotherUser.user})),U=(0,u.useState)(!1),J=(0,i.Z)(U,2),S=J[0],T=J[1],P=(0,u.useState)(""),z=(0,i.Z)(P,2),E=z[0],K=z[1],Q=(0,f.T)(),$=(0,u.useRef)(null),O=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var t,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,p.JU)(m.db,"users",c),e.next=3,(0,p.QT)(t);case 3:r=e.sent,w(r.data());case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,u.useEffect)((function(){O()}),[y.posts,C.posts]);var D=null===k||void 0===k?void 0:k.posts.find((function(e){return e.postId===l})),H=null===D||void 0===D?void 0:D.likes.find((function(e){return e.uid===y.uid})),M=(0,h.Z)(),W=M.likePost,A=M.removeLike,B=null===y||void 0===y||null===(t=y.savedPosts)||void 0===t?void 0:t.find((function(e){return e.postId===(null===D||void 0===D?void 0:D.postId)})),L=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Q,e.next=3,(0,v.I)({text:E,postId:l,userId:c});case 3:e.t1=e.sent,(0,e.t0)(e.t1),K("");case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,N.jsxs)("div",{className:"sm:w-[40%] w-[60%] sm:h-[800px]  h-[500px]  bg-white   flex flex-col   my-8 pb-8 ",children:[(0,N.jsxs)("div",{className:"flex items-center  p-2",children:[(0,N.jsx)("img",{className:"border-[1px] rounded-full h-10 w-10 mr-2",src:null!==k&&void 0!==k&&k.profileImage?null===k||void 0===k?void 0:k.profileImage:"/Instagram-clone/sign-in/images/profile.png",alt:""}),(0,N.jsx)(x.rU,{className:"hover:text-zinc-400",to:"/".concat(c,"/"),children:null===k||void 0===k?void 0:k.userName})]}),(0,N.jsx)("div",{className:"bg-black flex items-center justify-center  w-[100%] h-[80%] ",children:(0,N.jsx)("img",{className:"   w-full h-full    flex items-center justify-center object-contain",src:o,alt:""})}),(0,N.jsxs)("div",{className:"flex justify-between",children:[(0,N.jsxs)("div",{className:"flex mt-2  p-2",children:[(0,N.jsx)("h1",{className:"mr-2",children:H?(0,N.jsx)("i",{onClick:function(){return A({postId:l,uid:c})},className:"ri-heart-3-fill text-2xl text-red-400 cursor-pointer"}):(0,N.jsx)("i",{onClick:function(){return W({postId:l,uid:c})},className:"ri-heart-3-line text-2xl cursor-pointer hover:text-zinc-400"})}),(0,N.jsx)("i",{onClick:function(){var e;return null===(e=$.current)||void 0===e?void 0:e.focus()},className:"ri-chat-3-line text-2xl cursor-pointer hover:text-zinc-400 mr-2"}),(0,N.jsx)("i",{onClick:function(){return T(!0)},className:"ri-send-plane-line pt-[1px] cursor-pointer text-2xl hover:text-zinc-400"}),(0,N.jsx)(I.Z,{visible:S,setVisible:T,children:(0,N.jsx)(b.Z,{postId:l,profileImage:null===k||void 0===k?void 0:k.profileImage,user:c,postImage:o,userName:null===k||void 0===k?void 0:k.userName})})]}),y.uid===c?"":(0,N.jsx)("div",{className:"mt-2  p-2",children:B?(0,N.jsx)("i",{onClick:function(){return Q((0,g.D)(D))},className:"ri-bookmark-fill  text-2xl cursor-pointer"}):(0,N.jsx)("i",{className:"ri-bookmark-line text-2xl cursor-pointer hover:text-zinc-400",onClick:function(){return Q((0,Z.T)(D))}})})]}),(0,N.jsxs)("div",{className:"flex ml-2  ",children:[(0,N.jsx)("h1",{className:"mr-2",children:null===D||void 0===D||null===(r=D.likes)||void 0===r?void 0:r.length}),(0,N.jsx)("h1",{children:(null===D||void 0===D||null===(s=D.likes)||void 0===s?void 0:s.length)>1?"likes":"like"})]}),(0,N.jsxs)("div",{className:"flex justify-between p-2  items-center border-b-[1px] ",children:[(0,N.jsx)("textarea",{ref:$,className:"w-[90%] resize-none outline-none h-8  ",value:E,onChange:function(e){K(e.currentTarget.value)},name:"",id:"",placeholder:"Add a comment..."}),""!==E?(0,N.jsx)("button",{className:"text-blue-500 hover:text-black",onClick:function(){return L()},children:"Post"}):""]})]})},k=(0,u.memo)(j),w=r(3477),y=function(){var e=(0,o.v0)(),t=(0,f.C)((function(e){return e.user.user})),r=t.following,x=(0,u.useState)([]),h=(0,i.Z)(x,2),v=h[0],g=h[1],Z=v.map((function(e){return(0,N.jsx)(k,{postImage:e.postImage,user:e.user,postId:e.postId})})),I=!1;return(0,u.useEffect)((function(){if(!I&&(I=!0,t.uid)){r.forEach(function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var r,a,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,p.JU)(m.db,"users",t.uid),e.next=3,(0,p.QT)(r);case 3:a=e.sent,i=a.data(),console.log(null===i||void 0===i?void 0:i.posts),g((function(e){return[].concat((0,s.Z)(e),(0,s.Z)(null===i||void 0===i?void 0:i.posts))}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}),[t.uid]),e?(0,N.jsxs)("div",{className:"sm:flex  ",children:[(0,N.jsx)("div",{className:"w-[20%]",children:(0,N.jsx)(l.Z,{})}),0===r.length?(0,N.jsx)("div",{className:"w-[100%] h-[100vh] flex justify-center",children:(0,N.jsx)(w.Z,{})}):(0,N.jsx)("div",{className:"flex py-4  flex-col  justify-center items-center w-[100%]",children:Z})]}):(0,N.jsx)(d.Fg,{to:c.Z.SIGN_IN})},C=(0,u.memo)(y)},6130:function(e,t,r){r.d(t,{Z:function(){return p}});var n=r(4165),s=r(5861),a=r(9439),i=r(2791),u=r(4892),o=r(8937),c=r(4780),l=r(184),d=function(e){var t=e.uid,r=e.profileImage,n=e.userName,s=e.fullName,a=((0,o.Z)().chatWithUser,(0,u.T)()),i=(0,u.C)((function(e){return e.user.user})),d=(0,u.C)((function(e){return e.chat.chat})),f={userName:n,profileImage:r,uid:t,chatId:i.uid>t?i.uid+t:t+i.uid};return(0,l.jsxs)("div",{className:"flex p-2 hover:bg-zinc-200 cursor-pointer justify-between",children:[(0,l.jsxs)("div",{className:"flex w-[100%]",children:[(0,l.jsx)("img",{className:"h-12 w-12 rounded-3xl",src:r||"/Instagram-clone/sign-in/images/profile.png",alt:""}),(0,l.jsxs)("div",{className:"ml-2 text-[15px]",children:[(0,l.jsx)("h1",{className:"font-[500]",children:n}),(0,l.jsx)("h1",{className:"text-gray-400",children:s})]})]}),d.uid===t?(0,l.jsx)("i",{onClick:function(){return a((0,c.O6)())},className:"ri-checkbox-circle-fill text-2xl text-blue-400 "}):(0,l.jsx)("i",{onClick:function(){return a((0,c.OK)(f))},className:"ri-checkbox-blank-circle-line text-2xl"})]})},f=r(3797),p=function(e){var t=e.user,r=e.postImage,p=e.profileImage,m=[t,r,e.postId,p,e.userName],x=(0,u.C)((function(e){return e.user.user})),h=(0,u.C)((function(e){return e.chat.chat})),v=(0,i.useState)(),g=(0,a.Z)(v,2),Z=g[0],I=(g[1],(0,i.useState)("")),b=(0,a.Z)(I,2),N=b[0],j=(b[1],(0,u.T)()),k=(0,i.useState)(0),w=(0,a.Z)(k,2),y=(w[0],w[1],(0,o.Z)().chatWithUser),C=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y({uid:h.uid,profileImage:h.profileImage,userName:h.userName}),e.t0=j,e.next=4,(0,f.H)({selectedImage:Z,message:N,heart:"",post:m});case 4:e.t1=e.sent,(0,e.t0)(e.t1),j((0,c.O6)());case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),U=x.following.map((function(e){return(0,l.jsx)(d,{userName:e.userName,uid:e.uid,profileImage:e.profileImage,fullName:e.fullName})}));return(0,l.jsx)("div",{className:"bg-white w-[300px] sm:w-[500px] rounded-md flex  ",children:(0,l.jsxs)("div",{className:"w-[100%]",children:[(0,l.jsx)("div",{className:"flex border-b-[1px] justify-center py-2",children:(0,l.jsx)("h1",{children:"Share"})}),(0,l.jsxs)("div",{className:" border-b-[1px]",children:[(0,l.jsx)("h1",{className:"font-[500] text-[14px] p-2",children:"Suggested"}),(0,l.jsx)("div",{className:"overflow-auto  w-[100%] h-[300px]",children:U})]}),(0,l.jsx)("div",{className:"p-2",children:h.chatId?(0,l.jsx)("button",{onClick:C,className:"bg-blue-500 hover:bg-blue-600 text-white font-[500] w-[100%] rounded-md py-2",children:"Send"}):(0,l.jsx)("button",{disabled:!0,className:"bg-blue-200 text-white font-[500] w-[100%] rounded-md py-2 ",children:"Send"})})]})})}},8937:function(e,t,r){var n=r(4165),s=r(4942),a=r(5861),i=r(4892),u=r(7799),o=r(9222);t.Z=function(){var e=(0,i.C)((function(e){return e.user.user})),t=function(){var t=(0,a.Z)((0,n.Z)().mark((function t(r){var a,i,c,l,d,f,p,m,x;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=r.uid,i=r.userName,c=r.profileImage,l=e.uid>a?e.uid+a:a+e.uid,d={uid:a,userName:i,profileImage:c},f={uid:e.uid,userName:e.userName,profileImage:e.profileImage},p=(0,u.JU)(o.db,"chat",l),t.next=7,(0,u.QT)(p);case 7:if(t.sent.exists()){t.next=15;break}return t.next=11,(0,u.pl)((0,u.JU)(o.db,"chat",l),{message:[]});case 11:return t.next=13,(0,u.r7)((0,u.JU)(o.db,"chats",e.uid),(m={},(0,s.Z)(m,l+".userInfo",d),(0,s.Z)(m,l+".date",(0,u.Bt)()),m));case 13:return t.next=15,(0,u.r7)((0,u.JU)(o.db,"chats",a),(x={},(0,s.Z)(x,l+".userInfo",f),(0,s.Z)(x,l+".date",(0,u.Bt)()),x));case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return{chatWithUser:t}}},8094:function(e,t,r){var n=r(4165),s=r(3433),a=r(1413),i=r(5861),u=r(7799),o=r(4129),c=r(9222),l=r(4892),d=r(7562);t.Z=function(){var e=(0,l.C)((function(e){return e.anotherUser.user})),t=(0,l.C)((function(e){return e.user.user})),r=(0,l.T)(),f=function(){var l=(0,i.Z)((0,n.Z)().mark((function i(l){var f,p,m,x,h,v,g;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return p=l.uid,m=l.postId,x=(0,u.JU)(c.db,"users",p),n.next=4,(0,u.QT)(x);case 4:return h=n.sent,console.log(p),console.log(h.data()),v={userName:t.userName,fullName:t.fullName,profileImage:t.profileImage,uid:t.uid},g=null===(f=h.data())||void 0===f?void 0:f.posts.map((function(e){return e.postId===m?(0,a.Z)((0,a.Z)({},e),{},{likes:[].concat((0,s.Z)(e.likes),[v])}):e})),t.uid===p?r((0,o.av)((0,a.Z)((0,a.Z)({},t),{},{posts:g}))):r((0,d.xb)((0,a.Z)((0,a.Z)({},e),{},{posts:g}))),console.log(g),console.log(h.data()),n.next=14,(0,u.r7)(x,{posts:g});case 14:console.log(1);case 15:case"end":return n.stop()}}),i)})));return function(e){return l.apply(this,arguments)}}(),p=function(){var s=(0,i.Z)((0,n.Z)().mark((function s(i){var l,f,p,m,x,h,v,g,Z;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return p=i.uid,m=i.postId,x=(0,u.JU)(c.db,"users",p),n.next=4,(0,u.QT)(x);case 4:return h=n.sent,console.log(1),v=null===(l=h.data())||void 0===l?void 0:l.posts.find((function(e){return e.postId===m})),g=v.likes.filter((function(e){return e.uid!==t.uid})),Z=null===(f=h.data())||void 0===f?void 0:f.posts.map((function(e){return e.postId===m?(0,a.Z)((0,a.Z)({},e),{},{likes:g}):e})),t.uid===p?r((0,o.av)((0,a.Z)((0,a.Z)({},t),{},{posts:Z}))):r((0,d.xb)((0,a.Z)((0,a.Z)({},e),{},{posts:Z}))),n.next=12,(0,u.r7)(x,{posts:Z});case 12:case"end":return n.stop()}}),s)})));return function(e){return s.apply(this,arguments)}}();return{likePost:f,removeLike:p}}},4850:function(e,t,r){r.d(t,{I:function(){return f}});var n=r(4165),s=r(3433),a=r(1413),i=r(5861),u=r(9829),o=r(7799),c=r(4129),l=r(9222),d=r(7562),f=(0,u.hg)("user/addComment",function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){var i,f,p,m,x,h,v,g,Z,I,b,N;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f=t.text,p=t.postId,m=t.userId,x=r.dispatch,h=r.getState,v=h().user.user,g=h().anotherUser.user,v.posts,Z=(0,o.JU)(l.db,"users",m),e.next=8,(0,o.QT)(Z);case 8:return I=e.sent,b={userId:v.uid,text:f,likes:[],commentId:(0,u.x0)(),createdAt:(new Date).getTime()},N=null===(i=I.data())||void 0===i?void 0:i.posts.map((function(e){return e.postId===p?(0,a.Z)((0,a.Z)({},e),{},{commets:[].concat((0,s.Z)(e.commets),[b])}):e})),console.log(m),v.uid===m?x((0,c.av)((0,a.Z)((0,a.Z)({},v),{},{posts:N}))):x((0,d.xb)((0,a.Z)((0,a.Z)({},g),{},{posts:N}))),e.next=15,(0,o.r7)(Z,{posts:N});case 15:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}())},3797:function(e,t,r){r.d(t,{H:function(){return d}});var n=r(4165),s=r(4942),a=r(5861),i=r(9829),u=r(7799),o=r(9222),c=r(276),l=r(5854),d=(0,i.hg)("chat/addMessage",function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t,r){var a,i,d,f,p,m,x,h,v;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.selectedImage,i=t.message,d=t.heart,f=t.post,r.dispatch,p=r.getState,m=p().chat.chat,x=p().user.user,!a){e.next=15;break}return h=(0,c.iH)(o.tO,"Images/".concat((null===a||void 0===a?void 0:a.name)+(0,l.k$)())),e.next=8,(0,c.KV)(h,a);case 8:return e.next=10,(0,c.Jt)(h);case 10:return v=e.sent,e.next=13,(0,u.r7)((0,u.JU)(o.db,"chat",m.chatId),{message:(0,u.vr)({id:(0,l.k$)(),senderId:x.uid,date:u.EK.now(),image:v})});case 13:case 22:case 27:e.next=32;break;case 15:if(!i){e.next=24;break}return e.next=18,(0,u.r7)((0,u.JU)(o.db,"chat",m.chatId),{message:(0,u.vr)({id:(0,l.k$)(),message:i,senderId:x.uid,date:u.EK.now()})});case 18:return e.next=20,(0,u.r7)((0,u.JU)(o.db,"chats",x.uid),(0,s.Z)({},m.chatId+".lastMessage",{message:i}));case 20:return e.next=22,(0,u.r7)((0,u.JU)(o.db,"chats",m.uid),(0,s.Z)({},m.chatId+".lastMessage",{message:i}));case 24:if(!d){e.next=29;break}return e.next=27,(0,u.r7)((0,u.JU)(o.db,"chat",m.chatId),{message:(0,u.vr)({id:(0,l.k$)(),heart:d,senderId:x.uid,date:u.EK.now()})});case 29:if(!f){e.next=32;break}return e.next=32,(0,u.r7)((0,u.JU)(o.db,"chat",m.chatId),{message:(0,u.vr)({id:(0,l.k$)(),post:f,senderId:x.uid,date:u.EK.now()})});case 32:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}())},6112:function(e,t,r){r.d(t,{T:function(){return d}});var n=r(4165),s=r(3433),a=r(1413),i=r(5861),u=r(9829),o=r(9222),c=r(7799),l=r(4129),d=(0,u.hg)("user/addToSaved",function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){var i,u,d,f,p,m,x;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.postId,u=t.user,d=t.postImage,f=r.dispatch,p=r.getState,m=p().user.user,x={postImage:d,postId:i,user:u},e.next=6,(0,c.r7)((0,c.JU)(o.db,"users",m.uid),{savedPosts:(0,c.vr)(x)});case 6:f((0,l.av)((0,a.Z)((0,a.Z)({},m),{},{savedPosts:[].concat((0,s.Z)(m.savedPosts),[x])})));case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}())},1248:function(e,t,r){r.d(t,{D:function(){return l}});var n=r(4165),s=r(1413),a=r(5861),i=r(9829),u=r(9222),o=r(7799),c=r(4129),l=(0,i.hg)("user/removeSaved",function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t,r){var a,i,l,d,f;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.postId,i=r.dispatch,l=r.getState,d=l().user.user,f=d.savedPosts.filter((function(e){return e.postId!==a})),e.next=6,(0,o.r7)((0,o.JU)(u.db,"users",d.uid),{savedPosts:f});case 6:i((0,c.av)((0,s.Z)((0,s.Z)({},d),{},{savedPosts:f})));case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}())}}]);
//# sourceMappingURL=670.99825d2c.chunk.js.map