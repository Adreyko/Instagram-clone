"use strict";(self.webpackChunkinstragram=self.webpackChunkinstragram||[]).push([[259],{1735:function(e,s,t){t.r(s),t.d(s,{default:function(){return Z}});var r=t(9439),n=t(2791),a=t(7689),c=t(2222),i=t(2423),l=t(9222),o=t(4892),u=t(7799),d=t(3495),x=t(4780),m=t(184),h=function(e){var s=e.userName,t=e.profileImage,r=e.uid,a=e.chatId,c=e.lastMessage,i={userName:s,profileImage:t,uid:r,chatId:a},l=(0,o.C)((function(e){return e.chat.chat.chatId}));(0,n.useEffect)((function(){window.history.replaceState({},"#/".concat(a),"/direct")}),[]);var u=(0,o.T)();return(0,m.jsx)(d.fO,{to:"#/".concat(a),children:(0,m.jsxs)("div",{className:"flex p-2 hover:bg-zinc-100 cursor-pointer ".concat(a===l?"bg-zinc-200 hover:bg-zinc-200":""," "),onClick:function(){return u((0,x.OK)(i))},children:[(0,m.jsx)("img",{className:"border-[1px] rounded-full h-14 w-14 mt-2",src:t||"/Instagram-clone/images/profile.png",alt:""}),(0,m.jsxs)("div",{className:"flex flex-col justify-center  ml-2",children:[(0,m.jsx)("h1",{className:"  ",children:s}),(0,m.jsx)("h1",{className:"text-gray-400",children:c})]})]})})},f=(0,n.memo)(h),p=t(4165),j=t(5861),g=t(1087),v=function(e){var s=e.message,t=(e.postMessage,(0,o.C)((function(e){return e.user.user}))),r=(0,o.C)((function(e){return e.chat.chat.profileImage})),c=(0,o.C)((function(e){return e.chat.chat.uid})),i=(0,a.TH)(),l=((0,a.UO)().chatId,(0,n.useRef)(null));return(0,n.useEffect)((function(){var e;null===(e=l.current)||void 0===e||e.scrollIntoView({block:"end"})}),[s]),(0,n.useEffect)((function(){var e;null===(e=l.current)||void 0===e||e.scrollIntoView({block:"end"})}),[]),console.log(s.post),(0,m.jsx)("div",{ref:l,children:s.senderId===t.uid?(0,m.jsxs)("div",{className:"flex justify-end mt-2 mb-4",children:[s.message?(0,m.jsx)("div",{className:"  items-center ",children:(0,m.jsx)("h1",{className:" p-2 rounded-3xl bg-gray-200",children:s.message})}):"",s.image?(0,m.jsx)("div",{className:"",children:(0,m.jsx)("img",{src:"".concat(s.image),className:" rounded-3xl w-[200px] h-[200px]",alt:""})}):"",s.heart?(0,m.jsx)("i",{className:"ri-heart-fill text-red-500 text-4xl"}):"",s.post?(0,m.jsxs)("div",{className:"bg-gray-200 my-10 py-2 rounded-3xl w-[200px] h-[300px]",children:[(0,m.jsxs)(g.rU,{to:"/".concat(s.post[0],"/"),children:[" ",(0,m.jsxs)("div",{className:"flex p-4",children:[(0,m.jsx)("img",{className:"h-6 w-6 rounded-3xl mr-2 ",src:s.post[3],alt:""}),(0,m.jsx)("h1",{className:"text-[1rem]",children:s.post[4]})]})]}),(0,m.jsx)(g.rU,{to:"/".concat(s.post[0],"/").concat(s.post[2]),state:{background:i},children:(0,m.jsx)("img",{className:"w-full h-full  rounded-b-3xl object-cover",src:s.post[1],alt:"s"})})]}):""]}):(0,m.jsxs)("div",{className:"flex ",children:[(0,m.jsxs)(g.rU,{to:"/".concat(c,"/"),children:[" ",(0,m.jsx)("img",{className:"mt-8 w-8 h-8 flex  cursor-pointer rounded-2xl justify-end",src:r,alt:"dsada"})]}),(0,m.jsxs)("div",{className:"flex justify-start mt-2 mb-4",children:[s.message?(0,m.jsx)("div",{className:"  items-center ",children:(0,m.jsx)("h1",{className:" border-[1px] p-2 rounded-3xl",children:s.message})}):"",s.image?(0,m.jsx)("div",{className:"",children:(0,m.jsx)("img",{src:"".concat(s.image),className:" rounded-3xl w-[200px] h-[200px]",alt:""})}):"",s.heart?(0,m.jsx)("i",{className:"ri-heart-fill text-red-500 text-4xl"}):"",s.post?(0,m.jsxs)("div",{className:"bg-gray-200 my-10 py-2 rounded-3xl w-[200px] h-[300px]",children:[(0,m.jsxs)(g.rU,{to:"/".concat(s.post[0],"/"),children:[" ",(0,m.jsxs)("div",{className:"flex p-4",children:[(0,m.jsx)("img",{className:"h-6 w-6 rounded-3xl mr-2 ",src:s.post[3]?s.post[3]:"/Instagram-clone/images/profile.png",alt:""}),(0,m.jsxs)("h1",{children:[s.post[4]," "]})]})]}),(0,m.jsx)(g.rU,{to:"/".concat(s.post[0],"/").concat(s.post[2]),state:{background:i},children:(0,m.jsx)("img",{className:"w-full h-full  rounded-b-3xl object-cover",src:s.post[1],alt:"s"})})]}):""]})]})})},b=(0,n.memo)(v),N=t(833),w=t(3797),I=function(e){var s=e.showPicker,t=e.setShowPicker,a=(0,o.C)((function(e){return e.chat.chat.chatId})),c=(0,n.useState)([]),i=(0,r.Z)(c,2),d=i[0],x=i[1],h=(0,o.C)((function(e){return e.chat.chat.userName})),f=(0,o.C)((function(e){return e.chat.chat.uid})),v=(0,n.useState)(""),I=(0,r.Z)(v,2),k=I[0],y=I[1],Z=(0,n.useState)(),C=(0,r.Z)(Z,2),U=C[0],E=C[1],O=(0,o.C)((function(e){return e.chat.chat.profileImage})),S=(0,o.T)();(0,n.useEffect)((function(){a&&function(){var e=(0,u.cf)((0,u.JU)(l.db,"chat",a),(function(e){e.exists()&&x(e.data().message)}))}()}),[a]);var M=function(){var e=(0,j.Z)((0,p.Z)().mark((function e(s){var t;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.target.files){e.next=2;break}return e.abrupt("return");case 2:t=s.target.files[0],E(t);case 4:case"end":return e.stop()}}),e)})));return function(s){return e.apply(this,arguments)}}(),J=function(){var e=(0,j.Z)((0,p.Z)().mark((function e(s){return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=S,e.next=3,(0,w.H)({selectedImage:U,message:k,heart:"heart",post:""});case 3:e.t1=e.sent,(0,e.t0)(e.t1),y("");case 6:case"end":return e.stop()}}),e)})));return function(s){return e.apply(this,arguments)}}();(0,n.useEffect)((function(){var e=function(){var e=(0,j.Z)((0,p.Z)().mark((function e(){return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=S,e.next=3,(0,w.H)({selectedImage:U,message:k,heart:"",post:""});case 3:e.t1=e.sent,(0,e.t0)(e.t1),E(void 0);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();U&&e()}),[U]);var K=function(){var e=(0,j.Z)((0,p.Z)().mark((function e(s){return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!==s.key){e.next=7;break}return e.t0=S,e.next=4,(0,w.H)({selectedImage:U,message:k,heart:"heart",post:""});case 4:e.t1=e.sent,(0,e.t0)(e.t1),y("");case 7:case"end":return e.stop()}}),e)})));return function(s){return e.apply(this,arguments)}}(),H=d.map((function(e){return(0,m.jsx)(b,{message:e,postMessage:e.post})}));return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"p-4 border-b-[1px] flex items-center",children:(0,m.jsxs)(g.rU,{className:"flex items-center",to:"/".concat(f,"/"),children:[(0,m.jsx)("img",{className:"h-8 w-8 rounded-2xl mr-4 cursor-pointer",src:O,alt:""}),(0,m.jsxs)("h1",{className:" font-[500] cursor-pointer hover:text-zinc-400",children:[" ",h]})]})}),(0,m.jsx)("div",{className:"overflow-auto h-[100%]  w-[100%] justify-between p-4",children:H}),(0,m.jsx)("div",{className:"absolute bottom-16 ",onClick:function(e){return e.stopPropagation()},children:s&&(0,m.jsx)(N.ZP,{width:"100%",height:"400px",onEmojiClick:function(e){y((function(s){return s+e.emoji})),t(!1)}})}),(0,m.jsx)("div",{className:"px-2 p-4 flex justify-center items-center",children:(0,m.jsxs)("div",{className:" border w-[100%]   rounded-2xl flex justify-between items-center ",children:[(0,m.jsx)("h1",{className:"p-2 cursor-pointer",onClick:function(){return t((function(e){return!e}))},children:"\ud83d\ude00"}),(0,m.jsx)("input",{placeholder:"Message...",type:"text ",className:"outline-none p-2  w-[80%]",value:k,onChange:function(e){return y(e.target.value)},onKeyDown:K}),(0,m.jsx)("div",{className:"flex items-center ",children:k?(0,m.jsx)("button",{onClick:J,className:"text-blue-400 rounded-xl font-[500] p-2 ",children:"Send"}):(0,m.jsxs)("div",{className:" flex",children:[(0,m.jsxs)("label",{className:"cursor-pointer",children:[(0,m.jsx)("input",{type:"file",className:"hidden",onChange:M}),(0,m.jsx)("i",{className:"ri-image-line text-2xl"})]}),(0,m.jsx)("button",{onClick:J,className:"mx-2",children:(0,m.jsx)("i",{className:"ri-heart-line text-2xl"})})]})})]})})]})},k=(0,n.memo)(I),y=function(){var e,s=(0,o.C)((function(e){return e.user.user})),t=(0,n.useState)([]),d=(0,r.Z)(t,2),h=d[0],p=d[1],j=(0,o.C)((function(e){return e.chat.chat.chatId})),g=(0,n.useState)(!1),v=(0,r.Z)(g,2),b=v[0],N=v[1],w=(0,o.T)();(0,n.useEffect)((function(){s.uid&&function(){var e=(0,u.cf)((0,u.JU)(l.db,"chats",s.uid),(function(e){p(e.data())}))}()}),[s.uid]),(0,n.useEffect)((function(){w((0,x.O6)())}),[]),console.log(null===Object||void 0===Object?void 0:Object.entries(h));var I=null===Object||void 0===Object||null===(e=Object.entries(h))||void 0===e?void 0:e.map((function(e){var s;return(0,m.jsx)(f,{chatId:e[0],profileImage:e[1].userInfo.profileImage,userName:e[1].userInfo.userName,uid:e[1].userInfo.uid,lastMessage:null===(s=e[1].lastMessage)||void 0===s?void 0:s.message},e[0])}));return l.I8?(0,m.jsxs)("div",{className:"sm:flex bg-gray-50 h-[100vh]",children:[(0,m.jsx)("div",{className:"w-[20%]",children:(0,m.jsx)(c.Z,{})}),(0,m.jsxs)("div",{className:"bg-white xl:mx-[20%]  mb-8 border-[1px] rounded-md h-full flex w-[100%] justify-between   ",children:[(0,m.jsxs)("div",{className:"sm:w-[40%] ] border-r-[1px] flex flex-col justify-between   ",onClick:function(){return N(!1)},children:[(0,m.jsx)("div",{className:"flex justify-center p-4 border-b-[1px]",children:(0,m.jsxs)("h1",{className:"font-[500] py-1  ",children:[" ",s.userName]})}),(0,m.jsx)("div",{className:"overflow-auto h-[100%]  w-[100%] justify-between ",children:I})]}),(0,m.jsx)("div",{className:"w-[60%]   flex flex-col justify-between mb-16 sm:my-0 ",children:j?(0,m.jsx)(k,{showPicker:b,setShowPicker:N}):(0,m.jsxs)("div",{className:"flex flex-col justify-center items-center  h-[100%]",children:[(0,m.jsx)("img",{src:"/images/direct.png",alt:""}),(0,m.jsx)("h1",{className:"font-[500]",children:"Your Messages"}),(0,m.jsx)("h1",{className:"text-zinc-400",children:"Choose some one in left bar to chat"})]})})]})]}):(0,m.jsx)(a.Fg,{to:i.Z.SIGN_IN})},Z=(0,n.memo)(y)},3797:function(e,s,t){t.d(s,{H:function(){return d}});var r=t(4165),n=t(4942),a=t(5861),c=t(9829),i=t(7799),l=t(9222),o=t(276),u=t(5854),d=(0,c.hg)("chat/addMessage",function(){var e=(0,a.Z)((0,r.Z)().mark((function e(s,t){var a,c,d,x,m,h,f,p,j;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=s.selectedImage,c=s.message,d=s.heart,x=s.post,t.dispatch,m=t.getState,h=m().chat.chat,f=m().user.user,!a){e.next=15;break}return p=(0,o.iH)(l.tO,"Images/".concat((null===a||void 0===a?void 0:a.name)+(0,u.k$)())),e.next=8,(0,o.KV)(p,a);case 8:return e.next=10,(0,o.Jt)(p);case 10:return j=e.sent,e.next=13,(0,i.r7)((0,i.JU)(l.db,"chat",h.chatId),{message:(0,i.vr)({id:(0,u.k$)(),senderId:f.uid,date:i.EK.now(),image:j})});case 13:case 22:case 27:e.next=32;break;case 15:if(!c){e.next=24;break}return e.next=18,(0,i.r7)((0,i.JU)(l.db,"chat",h.chatId),{message:(0,i.vr)({id:(0,u.k$)(),message:c,senderId:f.uid,date:i.EK.now()})});case 18:return e.next=20,(0,i.r7)((0,i.JU)(l.db,"chats",f.uid),(0,n.Z)({},h.chatId+".lastMessage",{message:c}));case 20:return e.next=22,(0,i.r7)((0,i.JU)(l.db,"chats",h.uid),(0,n.Z)({},h.chatId+".lastMessage",{message:c}));case 24:if(!d){e.next=29;break}return e.next=27,(0,i.r7)((0,i.JU)(l.db,"chat",h.chatId),{message:(0,i.vr)({id:(0,u.k$)(),heart:d,senderId:f.uid,date:i.EK.now()})});case 29:if(!x){e.next=32;break}return e.next=32,(0,i.r7)((0,i.JU)(l.db,"chat",h.chatId),{message:(0,i.vr)({id:(0,u.k$)(),post:x,senderId:f.uid,date:i.EK.now()})});case 32:case"end":return e.stop()}}),e)})));return function(s,t){return e.apply(this,arguments)}}())}}]);
//# sourceMappingURL=259.b081b27b.chunk.js.map