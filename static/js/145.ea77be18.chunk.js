"use strict";(self.webpackChunkinstragram=self.webpackChunkinstragram||[]).push([[145],{6881:function(e,t,r){var s=r(2791),n=r(184),a=function(e){var t=e.visible,r=e.setVisible,s=e.children;return t?(0,n.jsx)("div",{className:"fixed inset-0 z-10   bg-opacity-30 backdrop-blur-sm flex justify-center items-center bg-gray-500",onClick:function(){return r(!1)},children:(0,n.jsx)("div",{onClick:function(e){return e.stopPropagation()},className:" rounded shadow-sm z-20",children:s})}):null};t.Z=(0,s.memo)(a)},8145:function(e,t,r){r.r(t),r.d(t,{default:function(){return b}});var s=r(4165),n=r(5861),a=r(9439),i=r(2791),c=r(7689),u=r(9222),o=r(7799),l=r(4850),d=r(4892),m=r(1087),f=r(184),x=function(e){var t=e.text,r=e.userId,c=(0,i.useState)(),l=(0,a.Z)(c,2),d=l[0],x=l[1];return(0,i.useEffect)((function(){var e=function(){var e=(0,n.Z)((0,s.Z)().mark((function e(){var t,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,o.JU)(u.db,"users",r),e.next=3,(0,o.QT)(t);case 3:n=e.sent,x(null===n||void 0===n?void 0:n.data());case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]),d&&(0,f.jsxs)("div",{className:"flex mt-2 ",children:[(0,f.jsx)(m.rU,{to:"/".concat(r,"/"),children:(0,f.jsx)("img",{className:"w-10 h-10 rounded-full mr-4 ",src:d.profileImage?d.profileImage:"/sign-in/images/profile.png",alt:""})}),(0,f.jsx)(m.rU,{to:"/".concat(r,"/"),children:(0,f.jsx)("h1",{className:"font-medium text-[13px]",children:d.userName})}),(0,f.jsx)("h1",{className:"ml-2",children:t})]})},p=r(8094),h=r(6881),v=function(e){var t=e.fullName,r=e.userName,s=e.profileImage,n=e.uid;return(0,f.jsxs)("div",{className:"flex items-center justify-between bg-white",children:[(0,f.jsxs)("div",{className:"flex py-2 mb-2",children:[(0,f.jsx)(m.rU,{to:"/".concat(n,"/"),children:(0,f.jsx)("img",{className:"border-[1px] rounded-full h-12 w-12",alt:"prof",src:s||"/images/profile.png"})}),(0,f.jsxs)("div",{className:"ml-2",children:[(0,f.jsx)("p",{className:"",children:r}),(0,f.jsx)("h1",{className:"text-gray-400",children:t})]})]}),(0,f.jsx)("div",{children:(0,f.jsx)("button",{className:"bg-zinc-200 p-1 px-3 rounded-md font-[600]",children:"Remove"})})]})},g=r(6112),N=r(1248),j=r(6130),b=function(){var e,t,r,m=(0,c.UO)(),b=m.postId,Z=m.uid,I=(0,c.s0)(),k=(0,d.T)(),w=(0,i.useState)(""),y=(0,a.Z)(w,2),C=y[0],U=y[1],S=(0,i.useState)(),J=(0,a.Z)(S,2),T=J[0],P=J[1],z=(0,d.C)((function(e){return e.user.user})),E=(0,d.C)((function(e){return e.anotherUser.user})),K=(0,i.useState)(!1),Q=(0,a.Z)(K,2),O=Q[0],$=Q[1],V=(0,i.useState)(!1),D=(0,a.Z)(V,2),H=D[0],L=D[1],M=(0,i.useRef)(null),W=function(){var e=(0,n.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=k,e.next=3,(0,l.I)({text:C,postId:b,userId:Z});case 3:e.t1=e.sent,(0,e.t0)(e.t1),U("");case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=(0,p.Z)(),B=A.likePost,R=A.removeLike,q=null===T||void 0===T?void 0:T.posts.find((function(e,t){return e.postId===b})),F=function(){var e=(0,n.Z)((0,s.Z)().mark((function e(){var t,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,o.JU)(u.db,"users",Z),e.next=3,(0,o.QT)(t);case 3:r=e.sent,P(r.data());case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,i.useEffect)((function(){F()}),[z.posts,E.posts]);var G=null===q||void 0===q?void 0:q.commets.map((function(e){return(0,f.jsx)(x,{text:e.text,userId:e.userId})})),X=null===q||void 0===q||null===(e=q.likes)||void 0===e?void 0:e.map((function(e){return(0,f.jsx)(v,{userName:e.userName,fullName:e.fullName,profileImage:e.profileImage,uid:e.uid})})),Y=null===q||void 0===q?void 0:q.likes.find((function(e){return e.uid===z.uid})),_=null===z||void 0===z||null===(t=z.savedPosts)||void 0===t?void 0:t.find((function(e){return e.postId===(null===q||void 0===q?void 0:q.postId)}));return console.log(_),(null===q||void 0===q?void 0:q.postId)&&(0,f.jsx)("div",{className:"fixed inset-0 z-10   bg-opacity-30 backdrop-blur-sm flex justify-center items-center bg-gray-500  ",onClick:function(){return I(-1)},children:(0,f.jsx)("div",{onClick:function(e){return e.stopPropagation()},className:"  rounded shadow-sm z-20 w-[70%]  ",children:(0,f.jsxs)("div",{className:"md:flex bg-white block w-full ",children:[(0,f.jsx)("div",{className:" flex items-center bg-black w-[100%]  h-[50vh] sm:h-[80vh] justify-center  ",children:(0,f.jsx)("img",{className:" object-contain w-[900px] h-[80vh] ",src:q.postImage,alt:""})}),(0,f.jsxs)("div",{className:"w-[100%]",children:[(0,f.jsx)("div",{className:"bg-white flex justify-between px-4 h-[75px] border-b-[1px] items-center ",children:(0,f.jsxs)("div",{className:"flex w-[100%] items-center ",children:[(0,f.jsx)("img",{className:"w-10 h-10 rounded-full mr-4",src:T.profileImage?T.profileImage:"/sign-in/images/profile.png",alt:""}),(0,f.jsx)("h1",{className:"",children:T.userName})]})}),(0,f.jsx)("div",{className:"  overflow-auto hidden md:flex  h-[50vh] p-4 ",children:q.commets.length>0||""!==q.text?(0,f.jsxs)("div",{children:[(0,f.jsxs)("div",{className:"flex",children:[(0,f.jsx)("img",{className:"w-10 h-10 rounded-full mr-4 ",src:T.profileImage?T.profileImage:"/sign-in/images/profile.png",alt:""}),(0,f.jsx)("h1",{className:"font-medium text-[13px]",children:T.userName}),(0,f.jsx)("h1",{className:"ml-2",children:q.text})]}),(0,f.jsx)("div",{className:"flex-col  ",children:G})]}):(0,f.jsxs)("div",{className:"flex flex-col items-center justify-center  w-[100%]",children:[(0,f.jsx)("h1",{className:"font-bold text-xl",children:"No comments yet."}),(0,f.jsx)("p",{className:"text-[15px]",children:"Start the conversation."})]})}),(0,f.jsxs)("div",{className:"flex justify-between mt-2 sm:border-t-[1px] p-2",children:[(0,f.jsxs)("div",{className:"flex",children:[(0,f.jsx)("h1",{className:"mr-2",children:Y?(0,f.jsx)("i",{onClick:function(){return R({postId:b,uid:Z})},className:"ri-heart-3-fill text-2xl text-red-400 cursor-pointer"}):(0,f.jsx)("i",{onClick:function(){return B({postId:b,uid:Z})},className:"ri-heart-3-line text-2xl cursor-pointer hover:text-zinc-400  "})}),(0,f.jsx)("h1",{className:"mr-2",children:(0,f.jsx)("i",{className:"ri-chat-3-line text-2xl cursor-pointer  hover:text-zinc-400",onClick:function(){var e;return null===(e=M.current)||void 0===e?void 0:e.focus()}})}),(0,f.jsx)("i",{onClick:function(){return $(!0)},className:"ri-send-plane-line pt-[1px]  cursor-pointer text-2xl hover:text-zinc-400"}),(0,f.jsx)(h.Z,{visible:O,setVisible:$,children:(0,f.jsx)(j.Z,{postId:b,profileImage:null===q||void 0===q?void 0:q.profileImage,user:T,postImage:q.postImage,userName:T.profileImage})})]}),z.uid===Z?"":(0,f.jsx)("div",{children:_?(0,f.jsx)("i",{onClick:function(){return k((0,N.D)(q))},className:"ri-bookmark-fill  text-2xl cursor-pointer"}):(0,f.jsx)("i",{className:"ri-bookmark-line text-2xl cursor-pointer hover:text-zinc-400",onClick:function(){return k((0,g.T)(q))}})})]}),(0,f.jsx)(h.Z,{visible:H,setVisible:L,children:X}),(0,f.jsxs)("div",{className:"flex ml-2 ",children:[(0,f.jsx)("h1",{className:"mr-2",children:null===(r=q.likes)||void 0===r?void 0:r.length}),(0,f.jsx)("h1",{onClick:function(){return L(!0)},children:"Like"})]}),(0,f.jsxs)("div",{className:"flex justify-between p-2 border-t-[1px]",children:[(0,f.jsx)("textarea",{ref:M,className:"w-[90%] resize-none outline-none ",value:C,onChange:function(e){U(e.currentTarget.value)},name:"",id:"",placeholder:"Add a comment..."}),""!==C?(0,f.jsx)("button",{className:"text-blue-500 hover:text-black",onClick:function(){return W()},children:"Post"}):""]})]})]})})})}},6130:function(e,t,r){r.d(t,{Z:function(){return f}});var s=r(4165),n=r(5861),a=r(9439),i=r(2791),c=r(4892),u=r(8937),o=r(4780),l=r(184),d=function(e){var t=e.uid,r=e.profileImage,s=e.userName,n=e.fullName,a=((0,u.Z)().chatWithUser,(0,c.T)()),i=(0,c.C)((function(e){return e.user.user})),d=(0,c.C)((function(e){return e.chat.chat})),m={userName:s,profileImage:r,uid:t,chatId:i.uid>t?i.uid+t:t+i.uid};return(0,l.jsxs)("div",{className:"flex p-2 hover:bg-zinc-200 cursor-pointer justify-between",children:[(0,l.jsxs)("div",{className:"flex w-[100%]",children:[(0,l.jsx)("img",{className:"h-12 w-12 rounded-3xl",src:r||"/sign-in/images/profile.png",alt:""}),(0,l.jsxs)("div",{className:"ml-2 text-[15px]",children:[(0,l.jsx)("h1",{className:"font-[500]",children:s}),(0,l.jsx)("h1",{className:"text-gray-400",children:n})]})]}),d.uid===t?(0,l.jsx)("i",{onClick:function(){return a((0,o.O6)())},className:"ri-checkbox-circle-fill text-2xl text-blue-400 "}):(0,l.jsx)("i",{onClick:function(){return a((0,o.OK)(m))},className:"ri-checkbox-blank-circle-line text-2xl"})]})},m=r(3797),f=function(e){var t=e.user,r=e.postImage,f=e.profileImage,x=[t,r,e.postId,f,e.userName],p=(0,c.C)((function(e){return e.user.user})),h=(0,c.C)((function(e){return e.chat.chat})),v=(0,i.useState)(),g=(0,a.Z)(v,2),N=g[0],j=(g[1],(0,i.useState)("")),b=(0,a.Z)(j,2),Z=b[0],I=(b[1],(0,c.T)()),k=(0,i.useState)(0),w=(0,a.Z)(k,2),y=(w[0],w[1],(0,u.Z)().chatWithUser),C=function(){var e=(0,n.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y({uid:h.uid,profileImage:h.profileImage,userName:h.userName}),e.t0=I,e.next=4,(0,m.H)({selectedImage:N,message:Z,heart:"",post:x});case 4:e.t1=e.sent,(0,e.t0)(e.t1),I((0,o.O6)());case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),U=p.following.map((function(e){return(0,l.jsx)(d,{userName:e.userName,uid:e.uid,profileImage:e.profileImage,fullName:e.fullName})}));return(0,l.jsx)("div",{className:"bg-white w-[300px] sm:w-[500px] rounded-md flex  ",children:(0,l.jsxs)("div",{className:"w-[100%]",children:[(0,l.jsx)("div",{className:"flex border-b-[1px] justify-center py-2",children:(0,l.jsx)("h1",{children:"Share"})}),(0,l.jsxs)("div",{className:" border-b-[1px]",children:[(0,l.jsx)("h1",{className:"font-[500] text-[14px] p-2",children:"Suggested"}),(0,l.jsx)("div",{className:"overflow-auto  w-[100%] h-[300px]",children:U})]}),(0,l.jsx)("div",{className:"p-2",children:h.chatId?(0,l.jsx)("button",{onClick:C,className:"bg-blue-500 hover:bg-blue-600 text-white font-[500] w-[100%] rounded-md py-2",children:"Send"}):(0,l.jsx)("button",{disabled:!0,className:"bg-blue-200 text-white font-[500] w-[100%] rounded-md py-2 ",children:"Send"})})]})})}},8937:function(e,t,r){var s=r(4165),n=r(4942),a=r(5861),i=r(4892),c=r(7799),u=r(9222);t.Z=function(){var e=(0,i.C)((function(e){return e.user.user})),t=function(){var t=(0,a.Z)((0,s.Z)().mark((function t(r){var a,i,o,l,d,m,f,x,p;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=r.uid,i=r.userName,o=r.profileImage,l=e.uid>a?e.uid+a:a+e.uid,d={uid:a,userName:i,profileImage:o},m={uid:e.uid,userName:e.userName,profileImage:e.profileImage},f=(0,c.JU)(u.db,"chat",l),t.next=7,(0,c.QT)(f);case 7:if(t.sent.exists()){t.next=15;break}return t.next=11,(0,c.pl)((0,c.JU)(u.db,"chat",l),{message:[]});case 11:return t.next=13,(0,c.r7)((0,c.JU)(u.db,"chats",e.uid),(x={},(0,n.Z)(x,l+".userInfo",d),(0,n.Z)(x,l+".date",(0,c.Bt)()),x));case 13:return t.next=15,(0,c.r7)((0,c.JU)(u.db,"chats",a),(p={},(0,n.Z)(p,l+".userInfo",m),(0,n.Z)(p,l+".date",(0,c.Bt)()),p));case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return{chatWithUser:t}}},8094:function(e,t,r){var s=r(4165),n=r(3433),a=r(1413),i=r(5861),c=r(7799),u=r(4129),o=r(9222),l=r(4892),d=r(7562);t.Z=function(){var e=(0,l.C)((function(e){return e.anotherUser.user})),t=(0,l.C)((function(e){return e.user.user})),r=(0,l.T)(),m=function(){var l=(0,i.Z)((0,s.Z)().mark((function i(l){var m,f,x,p,h,v,g;return(0,s.Z)().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return f=l.uid,x=l.postId,p=(0,c.JU)(o.db,"users",f),s.next=4,(0,c.QT)(p);case 4:return h=s.sent,console.log(f),console.log(h.data()),v={userName:t.userName,fullName:t.fullName,profileImage:t.profileImage,uid:t.uid},g=null===(m=h.data())||void 0===m?void 0:m.posts.map((function(e){return e.postId===x?(0,a.Z)((0,a.Z)({},e),{},{likes:[].concat((0,n.Z)(e.likes),[v])}):e})),t.uid===f?r((0,u.av)((0,a.Z)((0,a.Z)({},t),{},{posts:g}))):r((0,d.xb)((0,a.Z)((0,a.Z)({},e),{},{posts:g}))),console.log(g),console.log(h.data()),s.next=14,(0,c.r7)(p,{posts:g});case 14:console.log(1);case 15:case"end":return s.stop()}}),i)})));return function(e){return l.apply(this,arguments)}}(),f=function(){var n=(0,i.Z)((0,s.Z)().mark((function n(i){var l,m,f,x,p,h,v,g,N;return(0,s.Z)().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return f=i.uid,x=i.postId,p=(0,c.JU)(o.db,"users",f),s.next=4,(0,c.QT)(p);case 4:return h=s.sent,console.log(1),v=null===(l=h.data())||void 0===l?void 0:l.posts.find((function(e){return e.postId===x})),g=v.likes.filter((function(e){return e.uid!==t.uid})),N=null===(m=h.data())||void 0===m?void 0:m.posts.map((function(e){return e.postId===x?(0,a.Z)((0,a.Z)({},e),{},{likes:g}):e})),t.uid===f?r((0,u.av)((0,a.Z)((0,a.Z)({},t),{},{posts:N}))):r((0,d.xb)((0,a.Z)((0,a.Z)({},e),{},{posts:N}))),s.next=12,(0,c.r7)(p,{posts:N});case 12:case"end":return s.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return{likePost:m,removeLike:f}}},4850:function(e,t,r){r.d(t,{I:function(){return m}});var s=r(4165),n=r(3433),a=r(1413),i=r(5861),c=r(9829),u=r(7799),o=r(4129),l=r(9222),d=r(7562),m=(0,c.hg)("user/addComment",function(){var e=(0,i.Z)((0,s.Z)().mark((function e(t,r){var i,m,f,x,p,h,v,g,N,j,b,Z;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m=t.text,f=t.postId,x=t.userId,p=r.dispatch,h=r.getState,v=h().user.user,g=h().anotherUser.user,v.posts,N=(0,u.JU)(l.db,"users",x),e.next=8,(0,u.QT)(N);case 8:return j=e.sent,b={userId:v.uid,text:m,likes:[],commentId:(0,c.x0)(),createdAt:(new Date).getTime()},Z=null===(i=j.data())||void 0===i?void 0:i.posts.map((function(e){return e.postId===f?(0,a.Z)((0,a.Z)({},e),{},{commets:[].concat((0,n.Z)(e.commets),[b])}):e})),console.log(x),v.uid===x?p((0,o.av)((0,a.Z)((0,a.Z)({},v),{},{posts:Z}))):p((0,d.xb)((0,a.Z)((0,a.Z)({},g),{},{posts:Z}))),e.next=15,(0,u.r7)(N,{posts:Z});case 15:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}())},3797:function(e,t,r){r.d(t,{H:function(){return d}});var s=r(4165),n=r(4942),a=r(5861),i=r(9829),c=r(7799),u=r(9222),o=r(276),l=r(5854),d=(0,i.hg)("chat/addMessage",function(){var e=(0,a.Z)((0,s.Z)().mark((function e(t,r){var a,i,d,m,f,x,p,h,v;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.selectedImage,i=t.message,d=t.heart,m=t.post,r.dispatch,f=r.getState,x=f().chat.chat,p=f().user.user,!a){e.next=15;break}return h=(0,o.iH)(u.tO,"Images/".concat((null===a||void 0===a?void 0:a.name)+(0,l.k$)())),e.next=8,(0,o.KV)(h,a);case 8:return e.next=10,(0,o.Jt)(h);case 10:return v=e.sent,e.next=13,(0,c.r7)((0,c.JU)(u.db,"chat",x.chatId),{message:(0,c.vr)({id:(0,l.k$)(),senderId:p.uid,date:c.EK.now(),image:v})});case 13:case 22:case 27:e.next=32;break;case 15:if(!i){e.next=24;break}return e.next=18,(0,c.r7)((0,c.JU)(u.db,"chat",x.chatId),{message:(0,c.vr)({id:(0,l.k$)(),message:i,senderId:p.uid,date:c.EK.now()})});case 18:return e.next=20,(0,c.r7)((0,c.JU)(u.db,"chats",p.uid),(0,n.Z)({},x.chatId+".lastMessage",{message:i}));case 20:return e.next=22,(0,c.r7)((0,c.JU)(u.db,"chats",x.uid),(0,n.Z)({},x.chatId+".lastMessage",{message:i}));case 24:if(!d){e.next=29;break}return e.next=27,(0,c.r7)((0,c.JU)(u.db,"chat",x.chatId),{message:(0,c.vr)({id:(0,l.k$)(),heart:d,senderId:p.uid,date:c.EK.now()})});case 29:if(!m){e.next=32;break}return e.next=32,(0,c.r7)((0,c.JU)(u.db,"chat",x.chatId),{message:(0,c.vr)({id:(0,l.k$)(),post:m,senderId:p.uid,date:c.EK.now()})});case 32:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}())},6112:function(e,t,r){r.d(t,{T:function(){return d}});var s=r(4165),n=r(3433),a=r(1413),i=r(5861),c=r(9829),u=r(9222),o=r(7799),l=r(4129),d=(0,c.hg)("user/addToSaved",function(){var e=(0,i.Z)((0,s.Z)().mark((function e(t,r){var i,c,d,m,f,x,p;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.postId,c=t.user,d=t.postImage,m=r.dispatch,f=r.getState,x=f().user.user,p={postImage:d,postId:i,user:c},e.next=6,(0,o.r7)((0,o.JU)(u.db,"users",x.uid),{savedPosts:(0,o.vr)(p)});case 6:m((0,l.av)((0,a.Z)((0,a.Z)({},x),{},{savedPosts:[].concat((0,n.Z)(x.savedPosts),[p])})));case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}())},1248:function(e,t,r){r.d(t,{D:function(){return l}});var s=r(4165),n=r(1413),a=r(5861),i=r(9829),c=r(9222),u=r(7799),o=r(4129),l=(0,i.hg)("user/removeSaved",function(){var e=(0,a.Z)((0,s.Z)().mark((function e(t,r){var a,i,l,d,m;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.postId,i=r.dispatch,l=r.getState,d=l().user.user,m=d.savedPosts.filter((function(e){return e.postId!==a})),e.next=6,(0,u.r7)((0,u.JU)(c.db,"users",d.uid),{savedPosts:m});case 6:i((0,o.av)((0,n.Z)((0,n.Z)({},d),{},{savedPosts:m})));case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}())}}]);
//# sourceMappingURL=145.ea77be18.chunk.js.map